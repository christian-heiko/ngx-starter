{"version":3,"sources":["../../../../src/common/data/data-context-builder.ts"],"names":[],"mappings":"AAGA,OAAO,EAAC,WAAW,EAAe,MAAM,gBAAgB,CAAC;AACzD,OAAO,EAAC,gBAAgB,EAAC,MAAM,sBAAsB,CAAC;AAGtD,OAAO,EAAC,UAAU,EAAC,MAAM,iBAAiB,CAAC;AAC3C,OAAO,EAAC,mBAAmB,EAAC,MAAM,yBAAyB,CAAC;AAG5D;IAAA;QASU,cAAS,GAAY,EAAE,CAAC;QACxB,qBAAgB,GAAa,KAAK,CAAC;IAyD7C,CAAC;IAhEgB,wBAAK,GAApB;QACE,MAAM,CAAC,IAAI,kBAAkB,EAAK,CAAC;IACrC,CAAC;IAQM,oCAAO,GAAd,UAAe,OAA4B;QACzC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;QACxB,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAEM,qCAAQ,GAAf,UAAgB,IAAa;QAC3B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED;;;OAGG;IACI,yCAAY,GAAnB;QACE,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;QAC7B,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAEM,wCAAW,GAAlB,UAAmB,SAAkC;QACnD,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAC5B,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAEM,kCAAK,GAAZ,UAAc,WAA2E;QACvF,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,WAAW,CACtC,WAAW,EACX,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;IACpB,CAAC;IAGM,uCAAU,GAAjB,UACE,UAA8E;QAG9E,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,gBAAgB,CAC3C,UAAU,EACV,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,QAAQ,CACd,CAAC,CAAC;IACL,CAAC;IAEM,uCAAU,GAAjB;QACE,IAAI,YAAY,GAAG,IAAI,WAAW,CAAI,UAAC,CAAC,EAAE,CAAC,IAAI,OAAA,UAAU,CAAC,KAAK,EAAE,EAAlB,CAAkB,CAAC,CAAC;QACnE,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;IACzC,CAAC;IAEO,yCAAY,GAApB,UAAqB,OAA0B;QAC7C,EAAE,CAAA,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAA,CAAC;YACxB,OAAO,GAAG,IAAI,mBAAmB,CAAC,OAAO,CAAC,CAAC;QAC7C,CAAC;QACD,MAAM,CAAC,OAAO,CAAC;IACjB,CAAC;IAEH,yBAAC;AAAD,CAnEA,AAmEC,IAAA","file":"data-context-builder.js","sourceRoot":"","sourcesContent":["\n\n\nimport {DataContext, IDataContext} from \"./data-context\";\nimport {PagedDataContext} from \"./data-context-paged\";\nimport {Page, Pageable, Sort} from \"./page\";\nimport {Filter} from \"./filter\";\nimport {Observable} from \"rxjs/Observable\";\nimport {MaterialDataContext} from \"./data-context-material\";\n\n\nexport class DataContextBuilder<T> {\n\n\n  public static  start<T>() : DataContextBuilder<T> {\n    return new DataContextBuilder<T>();\n  }\n\n  private _indexFn? : ((item:T) => any);\n  private _localSort?: (a: T, b: T) => number;\n  private _pageSize : number = 30;\n  private _materialSupport : boolean = false;\n\n\n  public indexBy(indexFn? : ((item:T) => any)) : DataContextBuilder<T> {\n    this._indexFn = indexFn;\n    return this;\n  }\n\n  public pageSize(size : number) : DataContextBuilder<T> {\n    this._pageSize = size;\n    return this;\n  }\n\n  /**\n   * Adds support for Material DataSource to the resulting DataContext\n   * @returns {DataContextBuilder<T>}\n   */\n  public mdDataSource() : DataContextBuilder<T> {\n    this._materialSupport = true;\n    return this;\n  }\n\n  public localSorted(localSort : (a: T, b: T) => number) : DataContextBuilder<T> {\n    this._localSort = localSort;\n    return this;\n  }\n\n  public build( listFetcher : (sorts : Sort[], filters? : Filter[]) => Observable<Array<T>>) : IDataContext<T> {\n    return this.applyProxies(new DataContext<T>(\n      listFetcher,\n      this._indexFn));\n  }\n\n\n  public buildPaged(\n    pageLoader : (pageable : Pageable, filters? : Filter[]) => Observable<Page<T>>\n    ) : IDataContext<T> {\n\n    return this.applyProxies(new PagedDataContext<T>(\n      pageLoader,\n      this._pageSize,\n      this._indexFn\n    ));\n  }\n\n  public buildEmpty() : IDataContext<T> {\n    let emptyContext = new DataContext<T>((a, b)=> Observable.empty());\n    return this.applyProxies(emptyContext);\n  }\n\n  private applyProxies(context :  IDataContext<T>) : IDataContext<T> {\n    if(this._materialSupport){\n      context = new MaterialDataContext(context);\n    }\n    return context;\n  }\n\n}\n"]}