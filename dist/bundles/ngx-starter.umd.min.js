!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs/BehaviorSubject"),require("rxjs"),require("rxjs/Observable"),require("@angular/cdk"),require("@angular/common"),require("@angular/core"),require("@angular/material"),require("@angular/flex-layout"),require("@angular/router"),require("@ngx-translate/core"),require("@angular/http"),require("angular2-jwt"),require("@elderbyte/ngx-jwt-auth")):"function"==typeof define&&define.amd?define(["exports","rxjs/BehaviorSubject","rxjs","rxjs/Observable","@angular/cdk","@angular/common","@angular/core","@angular/material","@angular/flex-layout","@angular/router","@ngx-translate/core","@angular/http","angular2-jwt","@elderbyte/ngx-jwt-auth"],e):e((t.ng=t.ng||{},t.ng.ngxStarter=t.ng.ngxStarter||{}),t.rxjs_BehaviorSubject,t.rxjs,t.rxjs_Observable,t._angular_cdk,t._angular_common,t.ng.core,t._angular_material,t._angular_flexLayout,t.ng.router,t._ngxTranslate_core,t.ng.http,t.angular2Jwt,t._elderbyte_ngxJwtAuth)}(this,function(t,e,r,n,o,a,i,s,u,c,p,l,d,h){"use strict";function f(t,e,r,n){var o=function(){return n.isAuthenticated()&&n.principal?n.principal.token:""};return new J(t,e,new d.AuthConfig({tokenName:"token",tokenGetter:o,noJwtError:!1,globalHeaders:[{"Content-Type":"application/json"}]}),r)}var g=function(){function t(t,r,n){this.listFetcher=t,this._indexFn=r,this._localSort=n,this.total=0,this._dataChange=new e.BehaviorSubject([]),this._primaryIndex=new Map,this.rows=[],this.sorts=[]}return t.prototype.start=function(t,e){this.total=0,this.rows=[],this.sorts=t,this.filters=e,this.loadData()},Object.defineProperty(t.prototype,"hasMoreData",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.loadMore=function(){},t.prototype.findByIndex=function(t){if(!this._indexFn)throw new Error("findByIndex requires you to pass a index function!");return this._primaryIndex.get(t)},Object.defineProperty(t.prototype,"rowsChanged",{get:function(){return this._dataChange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},set:function(t){this._localSort&&t.sort(this._localSort),this._rows=t,console.info("rows changed data-change: "+this._rows.length),this._dataChange.next(t)},enumerable:!0,configurable:!0}),t.prototype.updateIndex=function(){var t=this;this._primaryIndex.clear(),this.rows.forEach(function(e){return t.indexItem(e)})},t.prototype.indexItem=function(t){var e=this.getItemKey(t);e&&this._primaryIndex.set(e,t)},t.prototype.getItemKey=function(t){return this._indexFn?this._indexFn(t):null},t.prototype.loadData=function(){var t=this;this.loadingIndicator=!0,this.listFetcher?this.listFetcher(this.sorts,this.filters).take(1).subscribe(function(e){t.total=e.length,t.rows=e,t.loadingIndicator=!1,console.log("got list data!")},function(e){t.total=0,t.rows=[],t.loadingIndicator=!1,t.updateIndex(),console.error("Failed to query data",e)}):console.warn("Skipping data context load - no list fetcher present!")},t}(),m=function(){function t(){}return t.from=function(e){var r=new t;return r.content=e,r.totalElements=e.length,r.totalPages=1,r.last=!0,r.first=!0,r.size=e.length,r.number=0,r.numberOfElements=e.length,r},t}(),y=function(){function t(t,e){this.prop=t,this.dir=e}return t}(),b=function(){function t(t,e,r){this.page=t,this.size=e,this.sorts=r}return t}(),x=function(){function t(){}return t.addSearchParams=function(t,e){if(t.set("page",e.page.toString()),t.set("size",e.size.toString()),e.sorts)for(var r=0,n=e.sorts;r<n.length;r++){var o=n[r];t.append("sort",o.prop+","+o.dir)}return t},t}(),v=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),P=function(t){function e(e,n,o,a){var i=t.call(this,function(){return r.Observable.empty()},o,a)||this;return i.pageLoader=e,i.pageCache=new Map,i.latestPage=0,i.offset=0,i.limit=30,i.limit=n,i}return v(e,t),e.prototype.start=function(t,e){this.total=0,this.rows=[],this.pageCache=new Map,this.sorts=t,this.filters=e,this.fetchPage(0,this.limit)},e.prototype.loadMore=function(){if(this.hasMoreData){if(console.log("loading more..."+this.latestPage),this.loadingIndicator)return;var t=this.latestPage+1;this.fetchPage(t,this.limit)}},Object.defineProperty(e.prototype,"hasMoreData",{get:function(){return this.total>this.rows.length},enumerable:!0,configurable:!0}),e.prototype.fetchPage=function(t,e){var r=this,n=new b(t,e,this.sorts);if(this.pageCache.has(t));else{this.loadingIndicator=!0,console.log("loading page "+t+" using sort:",this.sorts);var o=this.pageLoader(n,this.filters);this.pageCache.set(t,o),o.subscribe(function(t){console.log("Got data: ",t),r.populatePageData(t),r.latestPage<t.number&&(r.latestPage=t.number),r.loadingIndicator=!1},function(t){r.loadingIndicator=!1,console.error("Failed to query data",t)})}},e.prototype.populatePageData=function(t){try{this.total=t.totalElements;for(var e=t.number*t.size,r=this.rows.slice(),n=0;n<t.content.length;n++){var o=t.content[n];r[n+e]=o,this.indexItem(o)}this.rows=r}catch(e){console.error("Failed to populate data with page",t,e)}},e}(g),_=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),w=function(t){function e(e){var r=t.call(this)||this;if(r.datacontext=e,!e)throw Error("datacontext must not be NULL!");return r}return _(e,t),e.prototype.connect=function(t){return this.datacontext.rowsChanged},e.prototype.disconnect=function(t){},Object.defineProperty(e.prototype,"rows",{get:function(){return this.datacontext.rows},set:function(t){this.datacontext.rows=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"total",{get:function(){return this.datacontext.total},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sorts",{get:function(){return this.datacontext.sorts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return this.datacontext.filters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loadingIndicator",{get:function(){return this.datacontext.loadingIndicator},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowsChanged",{get:function(){return this.datacontext.rowsChanged},enumerable:!0,configurable:!0}),e.prototype.start=function(t,e){this.datacontext.start(t,e)},e.prototype.findByIndex=function(t){return this.datacontext.findByIndex(t)},Object.defineProperty(e.prototype,"hasMoreData",{get:function(){return this.datacontext.hasMoreData},enumerable:!0,configurable:!0}),e.prototype.loadMore=function(){this.datacontext.loadMore()},e}(o.DataSource),M=function(){function t(){this._pageSize=30,this._materialSupport=!1}return t.start=function(){return new t},t.prototype.indexBy=function(t){return this._indexFn=t,this},t.prototype.pageSize=function(t){return this._pageSize=t,this},t.prototype.mdDataSource=function(){return this._materialSupport=!0,this},t.prototype.localSorted=function(t){return this._localSort=t,this},t.prototype.build=function(t){return this.applyProxies(new g(t,this._indexFn))},t.prototype.buildPaged=function(t){return this.applyProxies(new P(t,this._pageSize,this._indexFn))},t.prototype.buildEmpty=function(){var t=new g(function(t,e){return n.Observable.empty()});return this.applyProxies(t)},t.prototype.applyProxies=function(t){return this._materialSupport&&(t=new w(t)),t},t}(),C=function(){function t(){}return t.fieldSort=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=e;return function(e,r){for(var o=0,a=0,i=n.length;0===a&&o<i;)a=t.dynamicSort(n[o])(e,r),o++;return a}},t.dynamicSort=function(e){var r=1;return"-"===e[0]&&(r=-1,e=e.substr(1)),function(n,o){var a=t.resolveProperty(n,e),i=t.resolveProperty(o,e);return(a<i?-1:a>i?1:0)*r}},t.resolveProperty=function(t,e){for(var r=e.split("."),n=t,o=0,a=r;o<a.length;o++){n=n[a[o]]}return n},t}(),O=function(){function t(t,e){this.key=t,this.value=e}return t}(),S=function(){function t(){}return t.addSearchParams=function(t,e){for(var r=0,n=e;r<n.length;r++){var o=n[r];t.append(o.key,o.value)}return t},t}(),j=function(){function t(){this.units=["bytes","KB","MB","GB","TB","PB"]}return t.prototype.transform=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=2),isNaN(parseFloat(String(t)))||!isFinite(t))return"?";for(var r=0;t>=1024;)t/=1024,r++;return t.toFixed(+e)+" "+this.units[r]},t.decorators=[{type:i.Pipe,args:[{name:"bytes"}]}],t.ctorParameters=function(){return[]},t}(),I=function(){function t(t,e){this.changeDetectorRef=t,this.ngZone=e}return t.prototype.transform=function(t){var e=this;if(this.removeTimer(),!t)return"unknown time";var r=new Date(t),n=new Date,o=Math.round(Math.abs((n.getTime()-r.getTime())/1e3)),a=1e3*this.getSecondsUntilUpdate(o);this.timer=this.ngZone.runOutsideAngular(function(){return"undefined"!=typeof window?window.setTimeout(function(){e.ngZone.run(function(){return e.changeDetectorRef.markForCheck()})},a):null});var i=Math.round(Math.abs(o/60)),s=Math.round(Math.abs(i/60)),u=Math.round(Math.abs(s/24)),c=Math.round(Math.abs(u/30.416)),p=Math.round(Math.abs(u/365));return o<=45?"a few seconds ago":o<=90?"a minute ago":i<=45?i+" minutes ago":i<=90?"an hour ago":s<=22?s+" hours ago":s<=36?"a day ago":u<=25?u+" days ago":u<=45?"a month ago":u<=345?c+" months ago":u<=545?"a year ago":p+" years ago"},t.prototype.ngOnDestroy=function(){this.removeTimer()},t.prototype.removeTimer=function(){this.timer&&(window.clearTimeout(this.timer),this.timer=null)},t.prototype.getSecondsUntilUpdate=function(t){return t<60?2:t<3600?30:t<86400?300:3600},t.decorators=[{type:i.Pipe,args:[{name:"timeAgo",pure:!1}]}],t.ctorParameters=function(){return[{type:i.ChangeDetectorRef},{type:i.NgZone}]},t}(),B=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{declarations:[j,I],exports:[j,I],imports:[a.CommonModule]}]}],t.ctorParameters=function(){return[]},t}(),D=function(){function t(){this._expandedChanged=new e.BehaviorSubject(!1)}return t.prototype.ngOnInit=function(){},Object.defineProperty(t.prototype,"expandedChanged",{get:function(){return this._expandedChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isExpanded",{get:function(){return this._isExpanded},set:function(t){this._isExpanded=t,this._expandedChanged.next(t)},enumerable:!0,configurable:!0}),t.prototype.onToggleExpand=function(t){this.isExpanded=!this.isExpanded},t.decorators=[{type:i.Component,args:[{selector:"expand-toggle-button",templateUrl:"./expand-toggle-button.component.html",styleUrls:["./expand-toggle-button.component.scss"]}]}],t.ctorParameters=function(){return[]},t.propDecorators={name:[{type:i.Input,args:["name"]}],expandedChanged:[{type:i.Output,args:["changed"]}],isExpanded:[{type:i.Input,args:["expanded"]}]},t}(),R=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{imports:[a.CommonModule,s.MdButtonModule,s.MdIconModule,u.FlexLayoutModule],declarations:[D],exports:[D]}]}],t.ctorParameters=function(){return[]},t}(),F=function(){function t(){}return t.prototype.ngOnInit=function(){},t.decorators=[{type:i.Component,args:[{selector:"app-access-denied",templateUrl:"./access-denied.component.html",styleUrls:["./access-denied.component.scss"]}]}],t.ctorParameters=function(){return[]},t}(),E=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{declarations:[F],exports:[F],imports:[a.CommonModule]}]}],t.ctorParameters=function(){return[]},t}(),q=function(){function t(){this.exactPathReplacers=new Map,this.exactPathHandlers=new Map,this.dynamicHandlers=[],this.replaceExactPath("/app",null)}return t.prototype.replaceExactPath=function(t,e){this.exactPathReplacers.set(t,e)},t.prototype.handleExactPath=function(t,e){this.exactPathHandlers.set(t,e)},t.prototype.addDynamicHandler=function(t){this.dynamicHandlers.push(t)},t.prototype.buildCrumb=function(t){if(this.exactPathReplacers.has(t)){var e=this.exactPathReplacers.get(t);return e?this.build(t,e):null}var r=this.exactPathHandlers.get(t);if(r)return r(t);for(var n=0,o=this.dynamicHandlers;n<o.length;n++){var a=o[n],i=a(t);if(i)return i}return this.buildCrumbFallback(t)},t.prototype.buildCrumbFallback=function(t){var e=t.split("/"),r=e[e.length-1];return r=r.split("(")[0],this.build(t,r)},t.prototype.build=function(t,e){return new A(e,t)},t}(),A=function(){function t(t,e){this.label=t,this.url=e}return t}(),U=function(){function t(){this.context=new q}return t.prototype.generateBreadcrumbs=function(t){var e=[],r=t.split("(")[0];return this.generateBreadcrumbsRecursive(r,e),e},t.prototype.generateBreadcrumbsRecursive=function(t,e){var r=this.buildCrumb(t);r&&e.unshift(r),t.lastIndexOf("/")>0?this.generateBreadcrumbsRecursive(t.substr(0,t.lastIndexOf("/")),e):this.context&&this.context.prefix&&e.unshift(this.context.prefix)},t.prototype.buildCrumb=function(t){return this.context.buildCrumb(t)},t.decorators=[{type:i.Injectable}],t.ctorParameters=function(){return[]},t}(),T=function(){function t(t,e,r){this.breadcrumbService=t,this.router=e,this.route=r,this.ROUTE_DATA_BREADCRUMB="breadcrumb",this.breadcrumbs=[]}return t.prototype.ngOnInit=function(){var t=this;this.router.events.filter(function(t){return t instanceof c.NavigationEnd}).map(function(t){return t}).subscribe(function(e){var r=e.urlAfterRedirects?e.urlAfterRedirects:e.url;t.updateBreadcrumbs(r)}),this.updateBreadcrumbs(location.pathname)},t.prototype.updateBreadcrumbs=function(t){this.breadcrumbs=this.getBreadcrumbs(t)},t.prototype.getBreadcrumbs=function(t){return this.breadcrumbService.generateBreadcrumbs(t)},t.decorators=[{type:i.Component,args:[{selector:"breadcrumb",templateUrl:"./breadcrumb.component.html",styleUrls:["./breadcrumb.component.scss"]}]}],t.ctorParameters=function(){return[{type:U},{type:c.Router},{type:c.ActivatedRoute}]},t}(),k=function(){function t(){}return t.decorators=[{type:i.NgModule,args:[{declarations:[T],providers:[U],exports:[T],imports:[a.CommonModule,c.RouterModule,s.MdIconModule,u.FlexLayoutModule]}]}],t.ctorParameters=function(){return[]},t}(),H=function(){function t(t){this.dialogRef=t}return t.decorators=[{type:i.Component,args:[{selector:"confirm-dialog",templateUrl:"./confirm-dialog.component.html",styleUrls:["./confirm-dialog.component.scss"]}]}],t.ctorParameters=function(){return[{type:s.MdDialogRef}]},t}(),L=function(){function t(t){this.dialog=t}return t.prototype.confirm=function(t,e){var r;return r=this.dialog.open(H),r.componentInstance.title=t,r.componentInstance.message=e,r.afterClosed()},t.decorators=[{type:i.Injectable}],t.ctorParameters=function(){return[{type:s.MdDialog}]},t}(),N=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[{provide:L,useClass:L}]}},t.decorators=[{type:i.NgModule,args:[{imports:[p.TranslateModule,s.MdDialogModule,s.MdButtonModule],exports:[H],declarations:[H],entryComponents:[H]}]}],t.ctorParameters=function(){return[]},t}(),z=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),J=function(t){function e(e,r,n,o){var a=t.call(this,n||new d.AuthConfig,e,r)||this;return a.translate=o,a}return z(e,t),e.prototype.request=function(e,r){return e instanceof l.Request?t.prototype.request.call(this,e):t.prototype.request.call(this,e,this.handleOptions(r))},e.prototype.get=function(e,r,n,o){return t.prototype.get.call(this,e,this.handleOptions(r,n,o))},e.prototype.post=function(e,r,n){return t.prototype.post.call(this,e,r,this.handleOptions(n))},e.prototype.put=function(e,r,n){return t.prototype.put.call(this,e,r,this.handleOptions(n))},e.prototype.delete=function(e,r){return t.prototype.delete.call(this,e,this.handleOptions(r))},e.prototype.patch=function(e,r,n){return t.prototype.patch.call(this,e,r,this.handleOptions(n))},e.prototype.head=function(e,r){return t.prototype.head.call(this,e,this.handleOptions(r))},e.prototype.options=function(e,r){return t.prototype.options.call(this,e,this.handleOptions(r))},e.prototype.handleOptions=function(t,e,r){return t||(t={}),e&&(t=this.addPageable(t,e)),r&&(t=this.addFilters(t,r)),t=this.addLocale(t)},e.prototype.addLocale=function(t){var e;return e=t.params?t.params:new l.URLSearchParams,e.set("locale",this.translate.currentLang),t.params=e,t},e.prototype.addPageable=function(t,e){var r;return r=t.params?t.params:new l.URLSearchParams,t.params=x.addSearchParams(r,e),t},e.prototype.addFilters=function(t,e){var r;return r=t.params?t.params:new l.URLSearchParams,t.params=S.addSearchParams(r,e),t},e.decorators=[{type:i.Injectable}],e.ctorParameters=function(){return[{type:l.Http},{type:l.RequestOptions},null,{type:p.TranslateService}]},e}(d.AuthHttp),Z=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[{provide:J,useFactory:f,deps:[l.Http,l.RequestOptions,p.TranslateService,h.AuthenticationService]}]}},t.decorators=[{type:i.NgModule,args:[{imports:[a.CommonModule,h.JwtAuthModule]}]}],t.ctorParameters=function(){return[]},t}();t.DataContext=g,t.DataContextBuilder=M,t.MaterialDataContext=w,t.PagedDataContext=P,t.ComparatorBuilder=C,t.Filter=O,t.FilterUtil=S,t.Page=m,t.Sort=y,t.Pageable=b,t.PageableUtil=x,t.CommonPipesModule=B,t.BytesPipe=j,t.TimeAgoPipe=I,t.ExpandToggleButtonModule=R,t.ExpandToggleButtonComponent=D,t.AccessDeniedModule=E,t.AccessDeniedComponent=F,t.BreadcrumbModule=k,t.BreadcrumbService=U,t.BreadcrumbComponent=T,t.CommonDialogModule=N,t.CommonDialogService=L,t.ConfirmDialog=H,t.CustomHttpModule=Z,t.createCustomHttpService=f,t.CustomHttpService=J,Object.defineProperty(t,"__esModule",{value:!0})});